/**
* EaselJS
* Visit http://easeljs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011 Grant Skinner
* 
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
* 
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
**/
(function(l){UID=function(){throw"UID cannot be instantiated";};UID._nextID=0;UID.get=function(){return UID._nextID++};l.UID=UID})(window);(function(l){Ticker=function(){throw"Ticker cannot be instantiated.";};Ticker._listeners=[];Ticker._pauseable=[];Ticker._paused=false;Ticker._inited=false;Ticker._startTime=0;Ticker._pausedTime=0;Ticker._ticks=0;Ticker._pausedTickers=0;Ticker._interval=20;Ticker._intervalID=null;Ticker._lastTime=0;Ticker._times=[];Ticker.addListener=function(a,b){if(!Ticker._inited){Ticker._inited=true;Ticker._startTime=Ticker._getTime();Ticker._times.push(0);Ticker.setInterval()}this.removeListener(a);Ticker._pauseable[Ticker._listeners.length]=
b==null?true:b;Ticker._listeners.push(a)};Ticker.removeListener=function(a){if(Ticker._listeners!=null){a=Ticker._listeners.indexOf(a);if(a!=-1){Ticker._listeners.splice(a,1);Ticker._pauseable.splice(a,1)}}};Ticker.removeAllListeners=function(){Ticker._listeners=[];Ticker._pauseable=[]};var c=function(){};Ticker.setInterval=function(a){Ticker._intervalID!=null&&clearInterval(Ticker._intervalID);Ticker._lastTime=Ticker.getTime(false);Ticker._interval=a||20;var b=l.requestAnimationFrame||l.mozRequestAnimationFrame||
l.webkitRequestAnimationFrame;if(typeof b==="function"&&(a===20||!a))(c=function(){b(Ticker._tick)})();else{c=function(){};Ticker._intervalID=setInterval(Ticker._tick,a)}};Ticker.getInterval=function(){return Ticker._interval};Ticker.getFPS=function(){return 1E3/Ticker._interval};Ticker.setFPS=function(a){Ticker.setInterval(1E3/a)};Ticker.getMeasuredFPS=function(a){if(Ticker._times.length<2)return-1;if(a==null)a=Ticker.getFPS()>>1;a=Math.min(Ticker._times.length-1,a);return 1E3/((Ticker._times[0]-
Ticker._times[a])/a)};Ticker.setPaused=function(a){Ticker._paused=a};Ticker.getPaused=function(){return Ticker._paused};Ticker.getTime=function(a){return Ticker._getTime()-Ticker._startTime-(a?Ticker._pausedTime:0)};Ticker.getTicks=function(a){return Ticker._ticks-(a?Ticker._pausedTickers:0)};Ticker._tick=function(){Ticker._ticks++;var a=Ticker.getTime(false),b=a-Ticker._lastTime,d=Ticker._paused;if(d){Ticker._pausedTickers++;Ticker._pausedTime+=b}Ticker._lastTime=a;for(var e=Ticker._pauseable,f=
Ticker._listeners.slice(),h=f?f.length:0,g=0;g<h;g++){var j=e[g],i=f[g];i==null||d&&j||i.tick==null||i.tick(b)}Ticker._times.unshift(a);Ticker._times.length>100&&Ticker._times.pop();c()};Ticker._getTime=function(){return(new Date).getTime()};l.Ticker=Ticker})(window);(function(l){MouseEvent=function(a,b,d){this.initialize(a,b,d)};var c=MouseEvent.prototype;c.stageX=0;c.stageY=0;c.type=null;c.nativeEvent=null;c.onMouseMove=null;c.onMouseUp=null;c.initialize=function(a,b,d){this.type=a;this.stageX=b;this.stageY=d};c.clone=function(){var a=new MouseEvent(this.type,this.stageX,this.stageY);a.nativeEvent=this.nativeEvent;return a};c.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"};l.MouseEvent=MouseEvent})(window);(function(l){Matrix2D=function(a,b,d,e,f,h){this.initialize(a,b,d,e,f,h)};var c=Matrix2D.prototype;Matrix2D.identity=null;Matrix2D.DEG_TO_RAD=Math.PI/180;c.a=1;c.b=0;c.c=0;c.d=1;c.tx=0;c.ty=0;c.alpha=1;c.shadow=null;c.compositeOperation=null;c.initialize=function(a,b,d,e,f,h){if(a!=null)this.a=a;if(b!=null)this.b=b;if(d!=null)this.c=d;if(e!=null)this.d=e;if(f!=null)this.tx=f;if(h!=null)this.ty=h};c.prepend=function(a,b,d,e,f,h){var g=this.tx;if(a!=1||b!=0||d!=0||e!=1){var j=this.a,i=this.c;this.a=
j*a+this.b*d;this.b=j*b+this.b*e;this.c=i*a+this.d*d;this.d=i*b+this.d*e}this.tx=g*a+this.ty*d+f;this.ty=g*b+this.ty*e+h};c.append=function(a,b,d,e,f,h){var g=this.a,j=this.b,i=this.c,k=this.d;this.a=a*g+b*i;this.b=a*j+b*k;this.c=d*g+e*i;this.d=d*j+e*k;this.tx=f*g+h*i+this.tx;this.ty=f*j+h*k+this.ty};c.prependMatrix=function(a){this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty);this.prependProperties(a.alpha,a.shadow,a.compositeOperation)};c.appendMatrix=function(a){this.append(a.a,a.b,a.c,a.d,a.tx,a.ty);this.appendProperties(a.alpha,
a.shadow,a.compositeOperation)};c.prependTransform=function(a,b,d,e,f,h,g,j,i){if(f%360){var k=f*Matrix2D.DEG_TO_RAD;f=Math.cos(k);k=Math.sin(k)}else{f=1;k=0}if(j||i){this.tx-=j;this.ty-=i}if(h||g){h*=Matrix2D.DEG_TO_RAD;g*=Matrix2D.DEG_TO_RAD;this.prepend(f*d,k*d,-k*e,f*e,0,0);this.prepend(Math.cos(g),Math.sin(g),-Math.sin(h),Math.cos(h),a,b)}else this.prepend(f*d,k*d,-k*e,f*e,a,b)};c.appendTransform=function(a,b,d,e,f,h,g,j,i){if(f%360){var k=f*Matrix2D.DEG_TO_RAD;f=Math.cos(k);k=Math.sin(k)}else{f=
1;k=0}if(h||g){h*=Matrix2D.DEG_TO_RAD;g*=Matrix2D.DEG_TO_RAD;this.append(Math.cos(g),Math.sin(g),-Math.sin(h),Math.cos(h),a,b);this.append(f*d,k*d,-k*e,f*e,0,0)}else this.append(f*d,k*d,-k*e,f*e,a,b);if(j||i){this.tx-=j*this.a+i*this.c;this.ty-=j*this.b+i*this.d}};c.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);var d=this.a,e=this.c,f=this.tx;this.a=d*b-this.b*a;this.b=d*a+this.b*b;this.c=e*b-this.d*a;this.d=e*a+this.d*b;this.tx=f*b-this.ty*a;this.ty=f*a+this.ty*b};c.skew=function(a,b){a*=Matrix2D.DEG_TO_RAD;
b*=Matrix2D.DEG_TO_RAD;this.append(Math.cos(b),Math.sin(b),-Math.sin(a),Math.cos(a),0,0)};c.scale=function(a,b){this.a*=a;this.d*=b;this.tx*=a;this.ty*=b};c.translate=function(a,b){this.tx+=a;this.ty+=b};c.identity=function(){this.alpha=this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;this.shadow=this.compositeOperation=null};c.invert=function(){var a=this.a,b=this.b,d=this.c,e=this.d,f=this.tx,h=a*e-b*d;this.a=e/h;this.b=-b/h;this.c=-d/h;this.d=a/h;this.tx=(d*this.ty-e*f)/h;this.ty=-(a*this.ty-b*
f)/h};c.decompose=function(a){if(a==null)a={};a.x=this.tx;a.y=this.ty;a.scaleX=Math.sqrt(this.a*this.a+this.b*this.b);a.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var b=Math.atan2(-this.c,this.d),d=Math.atan2(this.b,this.a);if(b==d){a.rotation=d/Matrix2D.DEG_TO_RAD;if(this.a<0&&this.d>=0)a.rotation+=a.rotation<=0?180:-180;a.skewX=a.skewY=0}else{a.skewX=b/Matrix2D.DEG_TO_RAD;a.skewY=d/Matrix2D.DEG_TO_RAD}return a};c.appendProperties=function(a,b,d){this.alpha*=a;this.shadow=b||this.shadow;this.compositeOperation=
d||this.compositeOperation};c.prependProperties=function(a,b,d){this.alpha*=a;this.shadow=this.shadow||b;this.compositeOperation=this.compositeOperation||d};c.clone=function(){var a=new Matrix2D(this.a,this.b,this.c,this.d,this.tx,this.ty);a.shadow=this.shadow;a.alpha=this.alpha;a.compositeOperation=this.compositeOperation;return a};c.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"};Matrix2D.identity=new Matrix2D(1,0,0,1,0,
0);l.Matrix2D=Matrix2D})(window);(function(l){Point=function(a,b){this.initialize(a,b)};var c=Point.prototype;c.x=0;c.y=0;c.initialize=function(a,b){this.x=a==null?0:a;this.y=b==null?0:b};c.clone=function(){return new Point(this.x,this.y)};c.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"};l.Point=Point})(window);(function(l){Rectangle=function(a,b,d,e){this.initialize(a,b,d,e)};var c=Rectangle.prototype;c.x=0;c.y=0;c.width=0;c.height=0;c.initialize=function(a,b,d,e){this.x=a==null?0:a;this.y=b==null?0:b;this.width=d==null?0:d;this.height=e==null?0:e};c.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)};c.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"};l.Rectangle=Rectangle})(window);(function(l){Shadow=function(a,b,d,e){this.initialize(a,b,d,e)};var c=Shadow.prototype;Shadow.identity=null;c.color=null;c.offsetX=0;c.offsetY=0;c.blur=0;c.initialize=function(a,b,d,e){this.color=a;this.offsetX=b;this.offsetY=d;this.blur=e};c.toString=function(){return"[Shadow]"};c.clone=function(){return new Shadow(this.color,this.offsetX,this.offsetY,this.blur)};Shadow.identity=new Shadow(null,0,0,0);l.Shadow=Shadow})(window);(function(l){SpriteSheet=function(a,b,d,e){this.initialize(a,b,d,e)};var c=SpriteSheet.prototype;c.image=null;c.frameWidth=0;c.frameHeight=0;c.frameData=null;c.loop=true;c.totalFrames=0;c.initialize=function(a,b,d,e){this.image=a;this.frameWidth=b;this.frameHeight=d;this.frameData=e};c.toString=function(){return"[SpriteSheet]"};c.clone=function(){var a=new SpriteSheet(this.image,this.frameWidth,this.frameHeight,this.frameData);a.loop=this.loop;a.totalFrames=this.totalFrames;return a};l.SpriteSheet=
SpriteSheet})(window);(function(l){function c(b,d){this.f=b;this.params=d}c.prototype.exec=function(b){this.f.apply(b,this.params)};Graphics=function(b){this.initialize(b)};var a=Graphics.prototype;Graphics.getRGB=function(b,d,e,f){if(b!=null&&e==null){f=d;e=b&255;d=b>>8&255;b=b>>16&255}return f==null?"rgb("+b+","+d+","+e+")":"rgba("+b+","+d+","+e+","+f+")"};Graphics.getHSL=function(b,d,e,f){return f==null?"hsl("+b%360+","+d+"%,"+e+"%)":"hsla("+b%360+","+d+"%,"+e+"%,"+f+")"};Graphics.STROKE_CAPS_MAP=["butt","round","square"];
Graphics.STROKE_JOINTS_MAP=["miter","round","bevel"];Graphics._ctx=document.createElement("canvas").getContext("2d");Graphics.beginCmd=new c(Graphics._ctx.beginPath,[]);Graphics.fillCmd=new c(Graphics._ctx.fill,[]);Graphics.strokeCmd=new c(Graphics._ctx.stroke,[]);a._strokeInstructions=null;a._strokeStyleInstructions=null;a._fillInstructions=null;a._instructions=null;a._oldInstructions=null;a._activeInstructions=null;a._active=false;a._dirty=false;a._minX=NaN;a._minY=NaN;a._maxX=NaN;a._maxY=NaN;a._boundsQueue=
null;a._x=0;a._y=0;a.initialize=function(b){this.clear();this._ctx=Graphics._ctx;with(this)eval(b)};a.draw=function(b){this._dirty&&this._updateInstructions();for(var d=this._instructions,e=0,f=d.length;e<f;e++)d[e].exec(b)};a.getBounds=function(){this._boundsQueue.length&&this._updateBounds();return isNaN(this._minX)?null:new Rectangle(this._minX,this._minY,this._maxX-this._minX,this._maxY-this._minY)};a.moveTo=function(b,d){this._activeInstructions.push(new c(this._ctx.moveTo,[b,d]));this._x=b;
this._y=d;return this};a.lineTo=function(b,d){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.lineTo,[b,d]));this._extendBounds(this._x,this._y);this._extendBounds(b,d);this._x=b;this._y=d;return this};a.arcTo=function(b,d,e,f,h){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.arcTo,[b,d,e,f,h]));return this};a.arc=function(b,d,e,f,h,g){this._dirty=this._active=true;if(g==null)g=false;this._activeInstructions.push(new c(this._ctx.arc,[b,d,e,
f,h,g]));return this};a.quadraticCurveTo=function(b,d,e,f){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.quadraticCurveTo,[b,d,e,f]));return this};a.bezierCurveTo=function(b,d,e,f,h,g){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.bezierCurveTo,[b,d,e,f,h,g]));this._boundsQueue.push(new c(this._bezierCurveToBounds,[_x,_y,b,d,e,f,h,g]));return this};a.rect=function(b,d,e,f){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.rect,
[b,d,e-1,f]));this._extendBounds(b,d);this._extendBounds(b+e,d+f);return this};a.closePath=function(){if(this._active){this._dirty=true;this._activeInstructions.push(new c(this._ctx.closePath,[]))}return this};a.clear=function(){this._instructions=[];this._oldInstructions=[];this._activeInstructions=[];this._strokeStyleInstructions=this._strokeInstructions=this._fillInstructions=null;this._active=this._dirty=false;this._boundsQueue=[];this._minX=this._minY=this._maxX=this._maxY=NaN;return this};a.beginFill=
function(b){this._active&&this._newPath();this._fillInstructions=b?[new c(this._setProp,["fillStyle",b])]:null;return this};a.beginLinearGradientFill=function(b,d,e,f,h,g){this._active&&this._newPath();e=this._ctx.createLinearGradient(e,f,h,g);f=0;for(h=b.length;f<h;f++)e.addColorStop(d[f],b[f]);this._fillInstructions=[new c(this._setProp,["fillStyle",e])];return this};a.beginRadialGradientFill=function(b,d,e,f,h,g,j,i){this._active&&this._newPath();e=this._ctx.createRadialGradient(e,f,h,g,j,i);f=
0;for(h=b.length;f<h;f++)e.addColorStop(d[f],b[f]);this._fillInstructions=[new c(this._setProp,["fillStyle",e])];return this};a.beginBitmapFill=function(b,d){this._active&&this._newPath();d=d||"";b=this._ctx.createPattern(b,d);this._fillInstructions=[new c(this._setProp,["fillStyle",b])];return this};a.endFill=function(){this.beginFill(null);return this};a.setStrokeStyle=function(b,d,e,f){this._active&&this._newPath();this._strokeStyleInstructions=[new c(this._setProp,["lineWidth",b==null?"1":b]),
new c(this._setProp,["lineCap",d==null?"butt":isNaN(d)?d:Graphics.STROKE_CAPS_MAP[d]]),new c(this._setProp,["lineJoin",e==null?"miter":isNaN(e)?e:Graphics.STROKE_JOINTS_MAP[e]]),new c(this._setProp,["miterLimit",f==null?"10":f])];return this};a.beginStroke=function(b){this._active&&this._newPath();this._strokeInstructions=b?[new c(this._setProp,["strokeStyle",b])]:null;return this};a.beginLinearGradientStroke=function(b,d,e,f,h,g){this._active&&this._newPath();e=this._ctx.createLinearGradient(e,f,
h,g);f=0;for(h=b.length;f<h;f++)e.addColorStop(d[f],b[f]);this._strokeInstructions=[new c(this._setProp,["strokeStyle",e])];return this};a.beginRadialGradientStroke=function(b,d,e,f,h,g,j,i){this._active&&this._newPath();e=this._ctx.createRadialGradient(e,f,h,g,j,i);f=0;for(h=b.length;f<h;f++)e.addColorStop(d[f],b[f]);this._strokeInstructions=[new c(this._setProp,["strokeStyle",e])];return this};a.beginBitmapStroke=function(b,d){this._active&&this._newPath();d=d||"";b=this._ctx.createPattern(b,d);
this._strokeInstructions=[new c(this._setProp,["strokeStyle",b])];return this};a.endStroke=function(){this.beginStroke(null);return this};a.curveTo=a.quadraticCurveTo;a.drawRect=a.rect;a.drawRoundRect=function(b,d,e,f,h){this.drawRoundRectComplex(b,d,e,f,h,h,h,h);return this};a.drawRoundRectComplex=function(b,d,e,f,h,g,j,i){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.moveTo,[b+h,d]),new c(this._ctx.lineTo,[b+e-g,d]),new c(this._ctx.arc,[b+e-g,d+g,g,-Math.PI/2,0,false]),
new c(this._ctx.lineTo,[b+e,d+f-j]),new c(this._ctx.arc,[b+e-j,d+f-j,j,0,Math.PI/2,false]),new c(this._ctx.lineTo,[b+i,d+f]),new c(this._ctx.arc,[b+i,d+f-i,i,Math.PI/2,Math.PI,false]),new c(this._ctx.lineTo,[b,d+h]),new c(this._ctx.arc,[b+h,d+h,h,Math.PI,Math.PI*3/2,false]));return this};a.drawCircle=function(b,d,e){this.arc(b,d,e,0,Math.PI*2);return this};a.drawEllipse=function(b,d,e,f){this._dirty=this._active=true;var h=e/2*0.5522848,g=f/2*0.5522848,j=b+e,i=d+f;e=b+e/2;f=d+f/2;this._activeInstructions.push(new c(this._ctx.moveTo,
[b,f]),new c(this._ctx.bezierCurveTo,[b,f-g,e-h,d,e,d]),new c(this._ctx.bezierCurveTo,[e+h,d,j,f-g,j,f]),new c(this._ctx.bezierCurveTo,[j,f+g,e+h,i,e,i]),new c(this._ctx.bezierCurveTo,[e-h,i,b,f+g,b,f]));return this};a.drawPolyStar=function(b,d,e,f,h,g){this._dirty=this._active=true;if(h==null)h=0;h=1-h;if(g==null)g=0;else g/=180/Math.PI;var j=Math.PI/f;this._activeInstructions.push(new c(this._ctx.moveTo,[b+Math.cos(g)*e,d+Math.sin(g)*e]));for(var i=0;i<f;i++){g+=j;h!=1&&this._activeInstructions.push(new c(this._ctx.lineTo,
[b+Math.cos(g)*e*h,d+Math.sin(g)*e*h]));g+=j;this._activeInstructions.push(new c(this._ctx.lineTo,[b+Math.cos(g)*e,d+Math.sin(g)*e]))}return this};a.clone=function(){var b=new Graphics;b._instructions=this._instructions.slice();b._activeInstructions=this._activeInstructions.slice();b._oldInstructions=this._oldInstructions.slice();if(this._fillInstructions)b._fillInstructions=this._fillInstructions.slice();if(this._strokeInstructions)b._strokeInstructions=this._strokeInstructions.slice();if(this._strokeStyleInstructions)b._strokeStyleInstructions=
this._strokeStyleInstructions.slice();b._active=this._active;b._dirty=this._dirty;return b};a.toString=function(){return"[Graphics]"};a.mt=a.moveTo;a.lt=a.lineTo;a.at=a.arcTo;a.bt=a.bezierCurveTo;a.qt=a.quadraticCurveTo;a.a=a.arc;a.r=a.rect;a.cp=a.closePath;a.c=a.clear;a.f=a.beginFill;a.lf=a.beginLinearGradientFill;a.rf=a.beginRadialGradientFill;a.bf=a.beginBitmapFill;a.ef=a.endFill;a.ss=a.setStrokeStyle;a.s=a.beginStroke;a.ls=a.beginLinearGradientStroke;a.rs=a.beginRadialGradientStroke;a.bs=a.beginBitmapStroke;
a.es=a.endStroke;a.dr=a.drawRect;a.rr=a.drawRoundRect;a.rc=a.drawRoundRectComplex;a.dc=a.drawCircle;a.de=a.drawEllipse;a.dp=a.drawPolyStar;a._updateInstructions=function(){this._instructions=this._oldInstructions.slice();this._instructions.push(Graphics.beginCmd);this._fillInstructions&&this._instructions.push.apply(this._instructions,this._fillInstructions);if(this._strokeInstructions){this._instructions.push.apply(this._instructions,this._strokeInstructions);this._strokeStyleInstructions&&this._instructions.push.apply(this._instructions,
this._strokeStyleInstructions)}this._instructions.push.apply(this._instructions,this._activeInstructions);this._fillInstructions&&this._instructions.push(Graphics.fillCmd);this._strokeInstructions&&this._instructions.push(Graphics.strokeCmd)};a._newPath=function(){this._dirty&&this._updateInstructions();this._oldInstructions=this._instructions;this._activeInstructions=[];this._active=this._dirty=false};a._setProp=function(b,d){this[b]=d};a._extendBounds=function(b,d){if(isNaN(this._minX)){this._minX=
this._maxX=b;this._minY=this._maxY=d}else{if(b<this._minX)this._minX=b;else if(b>this._maxX)this._maxX=b;if(d<this._minY)this._minY=d;else if(d>this._maxY)this._maxY=d}};a._updateBounds=function(){for(;boundsQueue.length;)boundsQueue.pop().exec(this)};a._bezierCurveToBounds=function(b,d,e,f,h,g,j,i){this._extendBounds(b,d);this._extendBounds(j,i)};l.Graphics=Graphics})(window);(function(l){DisplayObject=function(){this.initialize()};var c=DisplayObject.prototype;DisplayObject.suppressCrossDomainErrors=false;DisplayObject._hitTestCanvas=document.createElement("canvas");DisplayObject._hitTestCanvas.width=DisplayObject._hitTestCanvas.height=1;DisplayObject._hitTestContext=DisplayObject._hitTestCanvas.getContext("2d");DisplayObject._workingMatrix=new Matrix2D;c.alpha=1;c.cacheCanvas=null;c.id=-1;c.mouseEnabled=true;c.name=null;c.parent=null;c.regX=0;c.regY=0;c.rotation=0;c.scaleX=
1;c.scaleY=1;c.skewX=0;c.skewY=0;c.shadow=null;c.visible=true;c.x=0;c.y=0;c.compositeOperation=null;c.snapToPixel=false;c.onPress=null;c.onClick=null;c.onDoubleClick=null;c.onMouseOver=null;c.onMouseOut=null;c.filters=null;c._cacheOffsetX=0;c._cacheOffsetY=0;c._cacheDraw=false;c._activeContext=null;c._restoreContext=false;c._revertShadow=false;c._revertX=0;c._revertY=0;c._revertAlpha=1;c._minX=NaN;c._minY=NaN;c._maxX=NaN;c._maxY=NaN;c.initialize=function(){this.id=UID.get();this.children=[]};c.isVisible=
function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0};c.draw=function(a,b){if(b||!this.cacheCanvas)return false;a.drawImage(this.cacheCanvas,this._cacheOffsetX,this._cacheOffsetY);return true};c.cache=function(a,b,d,e){if(this.cacheCanvas==null)this.cacheCanvas=document.createElement("canvas");var f=this.cacheCanvas.getContext("2d");this.cacheCanvas.width=d;this.cacheCanvas.height=e;f.setTransform(1,0,0,1,-a,-b);f.clearRect(0,0,d+1,e+1);this.draw(f,true,new Matrix2D(1,0,0,
1,-a,-b));this._cacheOffsetX=a;this._cacheOffsetY=b;this._applyFilters()};c.updateCache=function(a){if(this.cacheCanvas==null)throw"cache() must be called before updateCache()";var b=this.cacheCanvas.getContext("2d");b.setTransform(1,0,0,1,-this._cacheOffsetX,-this._cacheOffsetY);if(a)b.globalCompositeOperation=a;else b.clearRect(0,0,this.cacheCanvas.width+1,this.cacheCanvas.height+1);this.draw(b,true);if(a)b.globalCompositeOperation="source-over";this._applyFilters()};c.uncache=function(){this.cacheCanvas=
null;this._cacheOffsetX=this._cacheOffsetY=0};c.getStage=function(){for(var a=this;a.parent;)a=a.parent;if(a instanceof Stage)return a;return null};c.localToGlobal=function(a,b){var d=this.getConcatenatedMatrix();if(d==null)return null;d.append(1,0,0,1,a,b);return new Point(d.tx,d.ty)};c.globalToLocal=function(a,b){var d=this.getConcatenatedMatrix();if(d==null)return null;d.invert();d.append(1,0,0,1,a,b);return new Point(d.tx,d.ty)};c.localToLocal=function(a,b,d){a=this.localToGlobal(a,b);return d.globalToLocal(a.x,
a.y)};c.setTransform=function(a,b,d,e,f,h,g,j,i){this.x=a||0;this.y=b||0;this.scaleX=d==null?1:d;this.scaleY=e==null?1:e;this.rotation=f||0;this.skewX=h||0;this.skewY=g||0;this.regX=j||0;this.regY=i||0};c.getConcatenatedMatrix=function(a){if(a)a.identity();else a=new Matrix2D;for(var b=this;b!=null;){a.prependTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY);a.prependProperties(b.alpha,b.shadow,b.compositeOperation);b=b.parent}return a};c.hitTest=function(a,b){var d=DisplayObject._hitTestContext,
e=DisplayObject._hitTestCanvas;d.setTransform(1,0,0,1,-a,-b);this.draw(d);a=this._testHit(d);e.width=0;e.width=1;return a};c.getBounds=function(){return this._cacheCanvas?new Rectangle(-this._cacheOffsetX,-this._cacheOffsetY,this.cacheCanvas.width,this.cacheCanvas.height):this._calculateBounds()};c.clone=function(){var a=new DisplayObject;this.cloneProps(a);return a};c.toString=function(){return"[DisplayObject (name="+this.name+")]"};c.cloneProps=function(a){a.alpha=this.alpha;a.name=this.name;a.regX=
this.regX;a.regY=this.regY;a.rotation=this.rotation;a.scaleX=this.scaleX;a.scaleY=this.scaleY;a.shadow=this.shadow;a.skewX=this.skewX;a.skewY=this.skewY;a.visible=this.visible;a.x=this.x;a.y=this.y;a.mouseEnabled=this.mouseEnabled;a.compositeOperation=this.compositeOperation};c.applyShadow=function(a,b){b=b||Shadow.identity;a.shadowColor=b.color;a.shadowOffsetX=b.offsetX;a.shadowOffsetY=b.offsetY;a.shadowBlur=b.blur};c._testHit=function(a){try{var b=a.getImageData(0,0,1,1).data[3]>1}catch(d){if(!DisplayObject.suppressCrossDomainErrors)throw"An error has occured. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images.";
}return b};c._applyFilters=function(){if(!(!this.filters||this.filters.length==0||!this.cacheCanvas))for(var a=this.filters.length,b=this.cacheCanvas.getContext("2d"),d=this.cacheCanvas.width,e=this.cacheCanvas.height,f=0;f<a;f++)this.filters[f].applyFilter(b,0,0,d,e)};c._calculateBounds=function(){return new Rectangle(0,0,0,0)};l.DisplayObject=DisplayObject})(window);(function(l){Container=function(){this.initialize()};var c=Container.prototype=new DisplayObject;c.children=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(){this.DisplayObject_initialize();this.children=[]};c.isVisible=function(){return this.visible&&this.alpha>0&&this.children.length&&this.scaleX!=0&&this.scaleY!=0};c.DisplayObject_draw=c.draw;c.draw=function(a,b,d){var e=Stage._snapToPixelEnabled;if(!d){d=new Matrix2D;d.appendProperties(this.alpha,this.shadow,this.compositeOperation)}if(this.DisplayObject_draw(a,
b))return true;b=this.children.length;for(var f=this.children.slice(0),h=0;h<b;h++){var g=f[h];g.tick&&g.tick();if(g.isVisible()){var j=false,i=d.clone();i.appendTransform(g.x,g.y,g.scaleX,g.scaleY,g.rotation,g.skewX,g.skewY,g.regX,g.regY);i.appendProperties(g.alpha,g.shadow,g.compositeOperation);if(!(g instanceof Container&&g.cacheCanvas==null)){e&&g.snapToPixel&&i.a==1&&i.b==0&&i.c==0&&i.d==1?a.setTransform(i.a,i.b,i.c,i.d,i.tx+0.5|0,i.ty+0.5|0):a.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);a.globalAlpha=
i.alpha;a.globalCompositeOperation=i.compositeOperation||"source-over";if(j=i.shadow)this.applyShadow(a,j)}g.draw(a,false,i);j&&this.applyShadow(a)}}return true};c.addChild=function(a){var b=arguments.length;if(b>1){for(var d=0;d<b;d++)this.addChild(arguments[d]);return arguments[b-1]}a.parent&&a.parent.removeChild(a);a.parent=this;this.children.push(a);return a};c.addChildAt=function(a,b){var d=arguments.length;if(d>2){b=arguments[e-1];for(var e=0;e<d-1;e++)this.addChildAt(arguments[e],b+e);return arguments[d-
2]}a.parent&&a.parent.removeChild(a);a.parent=this;this.children.splice(b,0,a);return a};c.removeChild=function(a){var b=arguments.length;if(b>1){for(var d=true,e=0;e<b;e++)d=d&&this.removeChild(arguments[e]);return d}return this.removeChildAt(this.children.indexOf(a))};c.removeChildAt=function(a){var b=arguments.length;if(b>1){for(var d=[],e=0;e<b;e++)d[e]=arguments[e];d.sort(function(h,g){return g-h});var f=true;for(e=0;e<b;e++)f=f&&this.removeChildAt(d[e]);return f}if(a<0||a>this.children.length-
1)return false;b=this.children[a];if(b!=null)b.parent=null;this.children.splice(a,1);return true};c.removeAllChildren=function(){for(;this.children.length;)this.removeChildAt(0)};c.getChildAt=function(a){return this.children[a]};c.sortChildren=function(a){this.children.sort(a)};c.getChildIndex=function(a){return this.children.indexOf(a)};c.getNumChildren=function(){return this.children.length};c.contains=function(a){for(;a;){if(a==this)return true;a=a.parent}return false};c.hitTest=function(a,b){return this.getObjectUnderPoint(a,
b)!=null};c.getObjectsUnderPoint=function(a,b){var d=[];a=this.localToGlobal(a,b);this._getObjectsUnderPoint(a.x,a.y,d);return d};c.getObjectUnderPoint=function(a,b){a=this.localToGlobal(a,b);return this._getObjectsUnderPoint(a.x,a.y)};c.clone=function(a){var b=new Container;this.cloneProps(b);if(a)for(var d=b.children=[],e=0,f=this.children.length;e<f;e++)d.push(this.children[e].clone(a));return b};c.toString=function(){return"[Container (name="+this.name+")]"};c._getObjectsUnderPoint=function(a,
b,d,e){var f=DisplayObject._hitTestContext,h=DisplayObject._hitTestCanvas,g=DisplayObject._workingMatrix,j=e&1&&(this.onPress||this.onClick||this.onDoubleClick)||e&2&&(this.onMouseOver||this.onMouseOut);if(this.cacheCanvas){this.getConcatenatedMatrix(g);f.setTransform(g.a,g.b,g.c,g.d,g.tx-a,g.ty-b);f.globalAlpha=g.alpha;this.draw(f);if(this._testHit(f)){h.width=0;h.width=1;if(j)return this}else return null}for(var i=this.children.length-1;i>=0;i--){var k=this.children[i];if(k.isVisible()&&k.mouseEnabled)if(k instanceof
Container)if(j){if(k=k._getObjectsUnderPoint(a,b))return this}else{k=k._getObjectsUnderPoint(a,b,d,e);if(!d&&k)return k}else if(!e||j||e&1&&(k.onPress||k.onClick||k.onDoubleClick)||e&2&&(k.onMouseOver||k.onMouseOut)){k.getConcatenatedMatrix(g);f.setTransform(g.a,g.b,g.c,g.d,g.tx-a,g.ty-b);f.globalAlpha=g.alpha;k.draw(f);if(this._testHit(f)){h.width=0;h.width=1;if(j)return this;else if(d)d.push(k);else return k}}}return null};c._calculateBounds=function(){};l.Container=Container})(window);(function(l){Stage=function(a,b){this.initialize(a,b)};var c=Stage.prototype=new Container;Stage._snapToPixelEnabled=false;c.autoClear=true;c.canvas=null;c.mouseX=null;c.mouseY=null;c.onMouseMove=null;c.onMouseUp=null;c.onMouseDown=null;c.snapToPixelEnabled=false;c.mouseInBounds=false;c._tmpCanvas=null;c._activeMouseEvent=null;c._activeMouseTarget=null;c._mouseOverIntervalID=null;c._mouseOverX=0;c._mouseOverY=0;c._mouseOverTarget=null;c.Container_initialize=c.initialize;c.initialize=function(a,b){this.Container_initialize();
this.canvas=a;this.mouseChildren=true;var d=this;if(b){a.addEventListener("touchstart",function(e){d._handleTouchStart(e)},false);document.addEventListener("touchend",function(e){d._handleTouchEnd(e)},false)}else{if(l.addEventListener){l.addEventListener("mouseup",function(e){d._handleMouseUp(e)},false);l.addEventListener("mousemove",function(e){d._handleMouseMove(e)},false);l.addEventListener("dblclick",function(e){d._handleDoubleClick(e)},false)}else if(document.addEventListener){document.addEventListener("mouseup",
function(e){d._handleMouseUp(e)},false);document.addEventListener("mousemove",function(e){d._handleMouseMove(e)},false);document.addEventListener("dblclick",function(e){d._handleDoubleClick(e)},false)}a.addEventListener("mousedown",function(e){d._handleMouseDown(e)},false)}};c.update=function(){if(this.canvas){this.autoClear&&this.clear();Stage._snapToPixelEnabled=this.snapToPixelEnabled;this.draw(this.canvas.getContext("2d"),false,this.getConcatenatedMatrix(DisplayObject._workingMatrix))}};c.tick=
c.update;c.clear=function(){if(this.canvas){var a=this.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);a.clearRect(0,0,this.canvas.width,this.canvas.height)}};c.toDataURL=function(a,b){b||(b="image/png");var d=this.canvas.getContext("2d"),e=this.canvas.width,f=this.canvas.height,h;if(a){h=d.getImageData(0,0,e,f);var g=d.globalCompositeOperation;d.globalCompositeOperation="destination-over";d.fillStyle=a;d.fillRect(0,0,e,f)}b=this.canvas.toDataURL(b);if(a){d.clearRect(0,0,e,f);d.putImageData(h,
0,0);d.globalCompositeOperation=g}return b};c.enableMouseOver=function(a){if(this._mouseOverIntervalID){clearInterval(this._mouseOverIntervalID);this._mouseOverIntervalID=null}if(!(a<=0)){var b=this;this._mouseOverIntervalID=setInterval(function(){b._testMouseOver()},1E3/Math.min(50,a));this._mouseOverX=NaN;this._mouseOverTarget=null}};c.clone=function(){var a=new Stage(null);this.cloneProps(a);return a};c.toString=function(){return"[Stage (name="+this.name+")]"};c._primaryTouchId=-1;c._handleTouchMoveListener=
null;c._handleTouchStart=function(a){a.preventDefault();a=a.changedTouches;if(this._primaryTouchId==-1){if(!this._handleTouchMoveListener){var b=this;this._handleTouchMoveListener=function(d){b._handleTouchMove(d)}}document.addEventListener("touchmove",this._handleTouchMoveListener,false);a=a[0];this._primaryTouchId=a.identifier;this._updateMousePosition(a.pageX,a.pageY);this._handleMouseDown(a)}};c._handleTouchMove=function(a){(a=this._findPrimaryTouch(a.changedTouches))&&this._handleMouseMove(a)};
c._handleTouchEnd=function(a){if(a=this._findPrimaryTouch(a.changedTouches)){this._handleMouseUp(a);this._primaryTouchId=-1;document.removeEventListener("touchmove",this._handleTouchMoveListener)}};c._findPrimaryTouch=function(a){for(var b=a.length,d,e=0;e<b;e++){d=a[e];if(d.identifier==this._primaryTouchId)return d}return null};c._handleMouseMove=function(a){if(this.canvas){if(!a)a=l.event;var b=this.mouseInBounds;this._updateMousePosition(a.pageX,a.pageY);if(b||this.mouseInBounds){b=new MouseEvent("onMouseMove",
this.mouseX,this.mouseY);b.nativeEvent=a;this.onMouseMove&&this.onMouseMove(b);this._activeMouseEvent&&this._activeMouseEvent.onMouseMove&&this._activeMouseEvent.onMouseMove(b)}}else this.mouseX=this.mouseY=null};c._updateMousePosition=function(a,b){var d=this.canvas;do{a-=d.offsetLeft;b-=d.offsetTop}while(d=d.offsetParent);if(this.mouseInBounds=a>=0&&b>=0&&a<this.canvas.width&&b<this.canvas.height){this.mouseX=a;this.mouseY=b}};c._handleMouseUp=function(a){var b=new MouseEvent("onMouseUp",this.mouseX,
this.mouseY);b.nativeEvent=a;this.onMouseUp&&this.onMouseUp(b);this._activeMouseEvent&&this._activeMouseEvent.onMouseUp&&this._activeMouseEvent.onMouseUp(b);if(this._activeMouseTarget&&this._activeMouseTarget.onClick&&this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,true,this._mouseOverIntervalID?3:1)==this._activeMouseTarget){b=new MouseEvent("onClick",this.mouseX,this.mouseY);b.nativeEvent=a;this._activeMouseTarget.onClick(b)}this._activeMouseEvent=this.activeMouseTarget=null};c._handleMouseDown=
function(a){var b;if(this.onMouseDown){b=new MouseEvent("onMouseDown",this.mouseX,this.mouseY);b.nativeEvent=a;this.onMouseDown(b)}var d=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,this._mouseOverIntervalID?3:1);if(d){if(d.onPress instanceof Function){b=new MouseEvent("onPress",this.mouseX,this.mouseY);b.nativeEvent=a;d.onPress(b);if(b.onMouseMove||b.onMouseUp)this._activeMouseEvent=b}this._activeMouseTarget=d}};c._testMouseOver=function(){if(!(this.mouseX==this._mouseOverX&&this.mouseY==
this._mouseOverY&&this.mouseInBounds)){var a=null;if(this.mouseInBounds){a=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,3);this._mouseOverX=this.mouseX;this._mouseOverY=this.mouseY}if(this._mouseOverTarget!=a){this._mouseOverTarget&&this._mouseOverTarget.onMouseOut&&this._mouseOverTarget.onMouseOut(new MouseEvent("onMouseOver",this.mouseX,this.mouseY));a&&a.onMouseOver&&a.onMouseOver(new MouseEvent("onMouseOut",this.mouseX,this.mouseY));this._mouseOverTarget=a}}};c._handleDoubleClick=function(a){var b;
if(this.onDoubleClick){b=new MouseEvent("onDoubleClick",this.mouseX,this.mouseY);b.nativeEvent=a;this.onDoubleClick(b)}var d=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,this._mouseOverIntervalID?3:1);if(d)if(d.onDoubleClick instanceof Function){b=new MouseEvent("onPress",this.mouseX,this.mouseY);b.nativeEvent=a;d.onDoubleClick(b)}};l.Stage=Stage})(window);(function(l){Bitmap=function(a){this.initialize(a)};var c=Bitmap.prototype=new DisplayObject;c.image=null;c.snapToPixel=true;c.DisplayObject_initialize=c.initialize;c.initialize=function(a){this.DisplayObject_initialize();this.image=a};c.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.image&&(this.image.complete||this.image.getContext)};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return true;a.drawImage(this.image,0,
0);return true};c.clone=function(){var a=new Bitmap(this.image);this.cloneProps(a);return a};c.toString=function(){return"[Bitmap (name="+this.name+")]"};c._calculateBounds=function(){return this.image&&(this.image.complete||this.image.getContext)?new Rectangle(0,0,this.image.width,this.image.height):new Rectangle(0,0,0,0)};l.Bitmap=Bitmap})(window);(function(l){BitmapSequence=function(a){this.initialize(a)};var c=BitmapSequence.prototype=new DisplayObject;c.callback=null;c.currentFrame=-1;c.currentSequence=null;c.currentEndFrame=null;c.currentStartFrame=null;c.nextSequence=null;c.paused=false;c.spriteSheet=null;c.snapToPixel=true;c.DisplayObject_initialize=c.initialize;c.initialize=function(a){this.DisplayObject_initialize();this.spriteSheet=a};c.isVisible=function(){var a=this.spriteSheet?this.spriteSheet.image:null;return this.visible&&this.alpha>
0&&this.scaleX!=0&&this.scaleY!=0&&a&&this.currentFrame>=0&&(a.complete||a.getContext)};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return true;b=this.spriteSheet.image;var d=this.spriteSheet.frameWidth,e=this.spriteSheet.frameHeight,f=b.width/d|0,h=b.height/e|0;if(this.currentEndFrame!=null){if(this.currentFrame>this.currentEndFrame){if(this.nextSequence)this._goto(this.nextSequence);else{this.paused=true;this.currentFrame=this.currentEndFrame}this.callback&&
this.callback(this)}}else{h=this.spriteSheet.totalFrames||f*h;if(this.currentFrame>=h){if(this.spriteSheet.loop)this.currentFrame=0;else{this.currentFrame=h-1;this.paused=true}this.callback&&this.callback(this)}}this.currentFrame>=0&&a.drawImage(b,d*(this.currentFrame%f),e*(this.currentFrame/f|0),d,e,0,0,d,e);return true};c.tick=function(){if(this.currentFrame==-1&&this.spriteSheet.frameData)this.paused=true;this.paused||this.currentFrame++};c.gotoAndPlay=function(a){this.paused=false;this._goto(a)};
c.gotoAndStop=function(a){this.paused=true;this._goto(a)};c.clone=function(){var a=new BitmapSequence(this.spriteSheet);this.cloneProps(a);return a};c.toString=function(){return"[BitmapSequence (name="+this.name+")]"};c.DisplayObject_cloneProps=c.cloneProps;c.cloneProps=function(a){this.DisplayObject_cloneProps(a);a.callback=this.callback;a.currentFrame=this.currentFrame;a.currentStartFrame=this.currentStartFrame;a.currentEndFrame=this.currentEndFrame;a.currentSequence=this.currentSequence;a.nextSequence=
this.nextSequence;a.paused=this.paused;a.frameData=this.frameData};c._goto=function(a){if(isNaN(a))if(a==this.currentSequence)this.currentFrame=this.currentStartFrame;else{var b=this.spriteSheet.frameData[a];if(b instanceof Array){this.currentFrame=this.currentStartFrame=b[0];this.currentSequence=a;this.currentEndFrame=b[1];if(this.currentEndFrame==null)this.currentEndFrame=this.currentStartFrame;if(this.currentEndFrame==null)this.currentEndFrame=this.currentFrame;this.nextSequence=b[2];if(this.nextSequence==
null)this.nextSequence=this.currentSequence;else if(this.nextSequence==false)this.nextSequence=null}else{this.currentSequence=this.nextSequence=null;this.currentEndFrame=this.currentFrame=this.currentStartFrame=b}}else{this.currentSequence=this.nextSequence=this.currentEndFrame=null;this.currentStartFrame=0;this.currentFrame=a}};c._calculateBounds=function(){return this.spriteSheet?new Rectangle(0,0,this.spriteSheet.frameWidth,this.spriteSheet.frameHeight):new Rectangle(0,0,0,0)};l.BitmapSequence=
BitmapSequence})(window);(function(l){Shape=function(a){this.initialize(a)};var c=Shape.prototype=new DisplayObject;c.graphics=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(a){this.DisplayObject_initialize();this.graphics=a?a:new Graphics};c.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.graphics};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return true;this.graphics.draw(a);return true};c.clone=function(a){a=new Shape(a&&
this.graphics?this.graphics.clone():this.graphics);this.cloneProps(a);return a};c.toString=function(){return"[Shape (name="+this.name+")]"};c._calculateBounds=function(){return this.graphics?this.graphics.getBounds():new Rectangle(0,0,0,0)};l.Shape=Shape})(window);(function(l){Text=function(a,b,d){this.initialize(a,b,d)};var c=Text.prototype=new DisplayObject;Text._workingContext=document.createElement("canvas").getContext("2d");c.text="";c.font=null;c.color=null;c.textAlign=null;c.textBaseline=null;c.maxWidth=null;c.outline=false;c.lineHeight=null;c.lineWidth=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(a,b,d){this.DisplayObject_initialize();this.text=a;this.font=b;this.color=d?d:"#000"};c.isVisible=function(){return Boolean(this.visible&&
this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.text!=null&&this.text!="")};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return true;if(this.outline)a.strokeStyle=this.color;else a.fillStyle=this.color;a.font=this.font;a.textAlign=this.textAlign?this.textAlign:"start";a.textBaseline=this.textBaseline?this.textBaseline:"alphabetic";b=String(this.text).split(/(?:\r\n|\r|\n)/);for(var d=this.lineHeight==null?this.getMeasuredLineHeight():this.lineHeight,e=0,f=0,
h=b.length;f<h;f++){var g=a.measureText(b[f]).width;if(this.lineWidth==null||g<this.lineWidth)this._drawTextLine(a,b[f],e);else{g=b[f].split(/(\s)/);for(var j=g[0],i=1,k=g.length;i<k;i+=2)if(a.measureText(j+g[i]+g[i+1]).width>this.lineWidth){this._drawTextLine(a,j,e);e+=d;j=g[i+1]}else j+=g[i]+g[i+1];this._drawTextLine(a,j,e)}e+=d}return true};c.getMeasuredWidth=function(){return this._getWorkingContext().measureText(this.text).width};c.getMeasuredLineHeight=function(){return this._getWorkingContext().measureText("M").width*
1.2};c.clone=function(){var a=new Text(this.text,this.font,this.color);this.cloneProps(a);return a};c.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"};c.DisplayObject_cloneProps=c.cloneProps;c.cloneProps=function(a){this.DisplayObject_cloneProps(a);a.textAlign=this.textAlign;a.textBaseline=this.textBaseline;a.maxWidth=this.maxWidth;a.outline=this.outline;a.lineHeight=this.lineHeight;a.lineWidth=this.lineWidth};c._getWorkingContext=function(){var a=
Text._workingContext;a.font=this.font;a.textAlign=this.textAlign?this.textAlign:"start";a.textBaseline=this.textBaseline?this.textBaseline:"alphabetic";return a};c._drawTextLine=function(a,b,d){this.outline?a.strokeText(b,0,d,this.maxWidth):a.fillText(b,0,d,this.maxWidth)};c._calculateBounds=function(){};l.Text=Text})(window);(function(l){SpriteSheetUtils=function(){throw"SpriteSheetUtils cannot be instantiated";};SpriteSheetUtils._workingCanvas=document.createElement("canvas");SpriteSheetUtils._workingContext=SpriteSheetUtils._workingCanvas.getContext("2d");SpriteSheetUtils.flip=function(c,a){var b=c.image,d=c.frameData,e=c.frameWidth;c=c.frameHeight;var f=b.width/e|0,h=b.height/c|0,g=f*h,j={},i;for(var k in d){i=d[k];if(i instanceof Array)i=i.slice(0);j[k]=i}var p=[],n=0,m=0;for(k in a){i=a[k];i=d[i[0]];if(i!=null){if(i instanceof
Array){var q=i[0],o=i[1];if(o==null)o=q}else q=o=i;p[m]=k;p[m+1]=q;p[m+2]=o;n+=o-q+1;m+=4}}d=SpriteSheetUtils._workingCanvas;d.width=b.width;d.height=Math.ceil(h+n/f)*c;n=SpriteSheetUtils._workingContext;n.drawImage(b,0,0,f*e,h*c,0,0,f*e,h*c);h=g-1;for(m=0;m<p.length;m+=4){k=p[m];q=p[m+1];o=p[m+2];i=a[k];g=i[1]?-1:1;for(var s=i[2]?-1:1,t=g==-1?e:0,u=s==-1?c:0,r=q;r<=o;r++){h++;n.save();n.translate(h%f*e+t,(h/f|0)*c+u);n.scale(g,s);n.drawImage(b,r%f*e,(r/f|0)*c,e,c,0,0,e,c);n.restore()}j[k]=[h-(o-
q),h,i[3]]}a=new Image;a.src=d.toDataURL("image/png");return new SpriteSheet(a.width>0?a:d,e,c,j)};SpriteSheetUtils.frameDataToString=function(c){var a="",b=0,d=0,e=0,f;for(var h in c){e++;f=c[h];if(f instanceof Array){var g=f[0],j=f[1];if(j==null)j=g;f=f[2];if(f==null)f=h}else{g=j=f;f=h}a+="\n\t"+h+", start="+g+", end="+j+", next="+f;if(f==false)a+=" (stop)";else if(f==h)a+=" (loop)";if(j>b)b=j;if(g<d)d=g}return a=e+" sequences, min="+d+", max="+b+a};SpriteSheetUtils.extractFrame=function(c,a){var b=
c.image,d=c.frameWidth,e=c.frameHeight,f=b.width/d|0;if(isNaN(a)){a=c.frameData[a];a=a instanceof Array?a[0]:a}c=SpriteSheetUtils._workingCanvas;c.width=d;c.height=e;SpriteSheetUtils._workingContext.drawImage(b,a%f*d,(a/f|0)*e,d,e,0,0,d,e);b=new Image;b.src=c.toDataURL("image/png");return b};l.SpriteSheetUtils=SpriteSheetUtils})(window);
